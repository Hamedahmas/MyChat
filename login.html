<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MyChat - ÙˆØ±ÙˆØ¯</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="container">
    <h1 id="title">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ MyChat</h1>
    <form onsubmit="login(event)">
      <input type="text" id="username" placeholder="Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ" required />
      <input type="password" id="password" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±" required />
      <button type="submit" id="loginBtn">ÙˆØ±ÙˆØ¯</button>
    </form>
    <p class="lang-switch">
      <a href="settings.html">ğŸŒ ØªØºÛŒÛŒØ± Ø²Ø¨Ø§Ù†</a>
    </p>
    <p id="error" class="message error" style="display:none;"></p>
  </div>

  <script>
    // ØªÙ†Ø¸ÛŒÙ… Ø²Ø¨Ø§Ù† Ùˆ Ø¬Ù‡Øª ØµÙØ­Ù‡
    const lang = localStorage.getItem('mychat_language') || 'fa';
    document.documentElement.lang = lang;
    document.documentElement.dir = (lang === 'fa' || lang === 'ar') ? 'rtl' : 'ltr';

    // ØªØ±Ø¬Ù…Ù‡â€ŒÙ‡Ø§
    const texts = {
      fa: {
        title: 'ÙˆØ±ÙˆØ¯ Ø¨Ù‡ MyChat',
        username: 'Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ',
        password: 'Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±',
        login: 'ÙˆØ±ÙˆØ¯',
        error: 'Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª'
      },
      en: {
        title: 'Login to MyChat',
        username: 'Username',
        password: 'Password',
        login: 'Login',
        error: 'Incorrect username or password'
      },
      ar: {
        title: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ MyChat',
        username: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…',
        password: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
        login: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        error: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©'
      },
      ja: {
        title: 'MyChat ã«ãƒ­ã‚°ã‚¤ãƒ³',
        username: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å',
        password: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
        login: 'ãƒ­ã‚°ã‚¤ãƒ³',
        error: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™'
      }
    };

    const t = texts[lang];
    document.getElementById('title').textContent = t.title;
    document.getElementById('username').placeholder = t.username;
    document.getElementById('password').placeholder = t.password;
    document.getElementById('loginBtn').textContent = t.login;

    // Ù„Ø§Ú¯ÛŒÙ† Ú©Ø§Ø±Ø¨Ø±
    function login(e) {
      e.preventDefault();
      const username = document.getElementById('username').value.trim();
      const password = document.getElementById('password').value.trim();

      const users = JSON.parse(localStorage.getItem('users')) || [];
      const user = users.find(u => u.username === username && u.password === password);

      if (user) {
        localStorage.setItem('currentUser', JSON.stringify(user));
        window.location.href = 'chat.html';
      } else {
        const error = document.getElementById('error');
        error.textContent = t.error;
        error.style.display = 'block';
      }
    }
  </script>
</body>
</html>
